{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import\"./home.css\";import Navbar from\"../../component/navbar/navbar\";import Footer from\"../../component/footer/footer\";import ProductSlider from\"../../component/product/product\";import{FaWhatsapp}from\"react-icons/fa\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Home(){const[cart,setCart]=useState(()=>JSON.parse(localStorage.getItem(\"cart\"))||[]);const[searchQuery,setSearchQuery]=useState(\"\");const[alertMessage,setAlertMessage]=useState(\"\");const[products,setProducts]=useState([]);const addToCart=async(product,quantity)=>{const existingProductIndex=cart.findIndex(item=>item.name===product.name);let updatedCart;if(existingProductIndex>-1){// Update quantity if product exists\nupdatedCart=cart.map((item,index)=>index===existingProductIndex?{...item,quantity:item.quantity+parseInt(quantity)}:item);}else{// Add new product to cart\nupdatedCart=[...cart,{...product,quantity:parseInt(quantity)}];}setCart(updatedCart);// Update the local cart state\nlocalStorage.setItem(\"cart\",JSON.stringify(updatedCart));// Sync with localStorage\ntry{// Send updated cart or new item to backend\nawait fetch(\"http://localhost:4000/cart\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({product,quantity})});setAlertMessage(`${product.name} has been added to the cart.`);}catch(error){console.error(\"Error updating cart on server:\",error);}};const removeFromCart=async productName=>{const updatedCart=cart.filter(item=>item.name!==productName);setCart(updatedCart);localStorage.setItem(\"cart\",JSON.stringify(updatedCart));// Sync with localStorage\ntry{await fetch(\"http://localhost:4000/cart\",{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({productName})});setAlertMessage(`${productName} has been removed from the cart.`);}catch(error){console.error(\"Error removing item from server:\",error);}};useEffect(()=>{const fetchCart=async()=>{try{const response=await fetch(\"http://localhost:4000/cart\");const cartData=await response.json();setCart(cartData);// Sync the cart state\n}catch(error){console.error(\"Error fetching cart:\",error);}};fetchCart();},[]);const[fadeOut,setFadeOut]=useState(false);useEffect(()=>{if(alertMessage){const timer=setTimeout(()=>{setFadeOut(true);},5000);return()=>clearTimeout(timer);}else{setFadeOut(false);}},[alertMessage]);useEffect(()=>{const fetchProducts=async()=>{try{const response=await fetch(\"http://localhost:4000/products\");if(!response.ok){throw new Error(\"Failed to fetch products\");}const data=await response.json();setProducts(data);}catch(error){console.error(\"Error fetching products:\",error);alert(\"Could not fetch products. Please try again later.\");}};fetchProducts();},[]);return/*#__PURE__*/_jsxs(\"main\",{className:\"Home\",children:[/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(Navbar,{cart:cart,setCart:setCart,setSearchQuery:setSearchQuery})}),/*#__PURE__*/_jsx(\"section\",{className:\"home-text-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row p-5 text-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-text\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Welcome to FoodStuff\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Where you can find the best food products\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-btn d-flex flex-column flex-md-row justify-content-center mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"col-12 col-md-4 my-1 mx-1\",children:\"New Product\"}),/*#__PURE__*/_jsx(\"button\",{className:\"col-12 col-md-4 my-1 mx-1\",children:\"All Products\"}),/*#__PURE__*/_jsx(\"button\",{className:\"col-12 col-md-4 my-1 mx-1\",children:\"Our Favorites\"})]})]})}),/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(ProductSlider,{products:products,addToCart:addToCart,removeFromCart:removeFromCart// Ensure to pass the remove function\n,searchQuery:searchQuery// Pass the search query to ProductSlider\n})}),alertMessage&&/*#__PURE__*/_jsx(\"div\",{className:`alert-popup ${fadeOut?'alert-popup-exit':''}`,children:alertMessage}),/*#__PURE__*/_jsx(\"section\",{className:\"footer mt-5\",children:/*#__PURE__*/_jsx(Footer,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"whatsapp-logo\",children:/*#__PURE__*/_jsx(\"a\",{href:\"https://wa.me/1234567890\"// Replace with your WhatsApp number\n,target:\"_blank\",rel:\"noopener noreferrer\",className:\"whatsapp-button\",children:/*#__PURE__*/_jsx(FaWhatsapp,{size:40,color:\"#25D366\"})})})]});}","map":{"version":3,"names":["React","useState","useEffect","Navbar","Footer","ProductSlider","FaWhatsapp","jsx","_jsx","jsxs","_jsxs","Home","cart","setCart","JSON","parse","localStorage","getItem","searchQuery","setSearchQuery","alertMessage","setAlertMessage","products","setProducts","addToCart","product","quantity","existingProductIndex","findIndex","item","name","updatedCart","map","index","parseInt","setItem","stringify","fetch","method","headers","body","error","console","removeFromCart","productName","filter","fetchCart","response","cartData","json","fadeOut","setFadeOut","timer","setTimeout","clearTimeout","fetchProducts","ok","Error","data","alert","className","children","href","target","rel","size","color"],"sources":["/Users/touchbar/Documents/GitHub/foodstuff-website/src/pages/home/home.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"./home.css\";\nimport Navbar from \"../../component/navbar/navbar\";\nimport Footer from \"../../component/footer/footer\";\nimport ProductSlider from \"../../component/product/product\";\nimport { FaWhatsapp } from \"react-icons/fa\";\n\nexport default function Home() {\n    const [cart, setCart] = useState(() => JSON.parse(localStorage.getItem(\"cart\")) || []);\n    const [searchQuery, setSearchQuery] = useState(\"\");\n    const [alertMessage, setAlertMessage] = useState(\"\");\n    const [products, setProducts] = useState([]);\n\n    const addToCart = async (product, quantity) => {\n        const existingProductIndex = cart.findIndex(item => item.name === product.name);\n        let updatedCart;\n\n        if (existingProductIndex > -1) {\n            // Update quantity if product exists\n            updatedCart = cart.map((item, index) =>\n                index === existingProductIndex\n                    ? { ...item, quantity: item.quantity + parseInt(quantity) }\n                    : item\n            );\n        } else {\n            // Add new product to cart\n            updatedCart = [...cart, { ...product, quantity: parseInt(quantity) }];\n        }\n\n        setCart(updatedCart); // Update the local cart state\n        localStorage.setItem(\"cart\", JSON.stringify(updatedCart)); // Sync with localStorage\n\n        try {\n            // Send updated cart or new item to backend\n            await fetch(\"http://localhost:4000/cart\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n                body: JSON.stringify({ product, quantity }),\n            });\n            setAlertMessage(`${product.name} has been added to the cart.`);\n        } catch (error) {\n            console.error(\"Error updating cart on server:\", error);\n        }\n    };\n\n    const removeFromCart = async (productName) => {\n        const updatedCart = cart.filter(item => item.name !== productName);\n        setCart(updatedCart);\n        localStorage.setItem(\"cart\", JSON.stringify(updatedCart)); // Sync with localStorage\n\n        try {\n            await fetch(\"http://localhost:4000/cart\", {\n                method: \"DELETE\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n                body: JSON.stringify({ productName }),\n            });\n            setAlertMessage(`${productName} has been removed from the cart.`);\n        } catch (error) {\n            console.error(\"Error removing item from server:\", error);\n        }\n    };\n\n    useEffect(() => {\n        const fetchCart = async () => {\n            try {\n                const response = await fetch(\"http://localhost:4000/cart\");\n                const cartData = await response.json();\n                setCart(cartData); // Sync the cart state\n            } catch (error) {\n                console.error(\"Error fetching cart:\", error);\n            }\n        };\n\n        fetchCart();\n    }, []);\n\n    const [fadeOut, setFadeOut] = useState(false);\n\n    useEffect(() => {\n        if (alertMessage) {\n            const timer = setTimeout(() => {\n                setFadeOut(true);\n            }, 5000);\n\n            return () => clearTimeout(timer);\n        } else {\n            setFadeOut(false);\n        }\n    }, [alertMessage]);\n\n    useEffect(() => {\n        const fetchProducts = async () => {\n            try {\n                const response = await fetch(\"http://localhost:4000/products\");\n                if (!response.ok) {\n                    throw new Error(\"Failed to fetch products\");\n                }\n                const data = await response.json();\n                setProducts(data);\n            } catch (error) {\n                console.error(\"Error fetching products:\", error);\n                alert(\"Could not fetch products. Please try again later.\");\n            }\n        };\n\n        fetchProducts();\n    }, []);\n\n    return (\n        <main className=\"Home\">\n            <section>\n                <Navbar cart={cart} setCart={setCart} setSearchQuery={setSearchQuery} />\n            </section>\n\n            <section className=\"home-text-wrapper\">\n                <div className=\"row p-5 text-center\">\n                    <div className=\"home-text\">\n                        <h1>Welcome to FoodStuff</h1>\n                        <span>Where you can find the best food products</span>\n                    </div>\n                    <div className=\"home-btn d-flex flex-column flex-md-row justify-content-center mt-4\">\n                        <button className=\"col-12 col-md-4 my-1 mx-1\">New Product</button>\n                        <button className=\"col-12 col-md-4 my-1 mx-1\">All Products</button>\n                        <button className=\"col-12 col-md-4 my-1 mx-1\">Our Favorites</button>\n                    </div>\n                </div>\n            </section>\n\n            <section>\n                <ProductSlider\n                    products={products}\n                    addToCart={addToCart}\n                    removeFromCart={removeFromCart} // Ensure to pass the remove function\n                    searchQuery={searchQuery} // Pass the search query to ProductSlider\n                />\n            </section>\n\n            {alertMessage && (\n                <div className={`alert-popup ${fadeOut ? 'alert-popup-exit' : ''}`}>\n                    {alertMessage}\n                </div>\n            )}\n\n            <section className=\"footer mt-5\">\n                <Footer />\n            </section>\n\n            <div className=\"whatsapp-logo\">\n                <a\n                    href=\"https://wa.me/1234567890\" // Replace with your WhatsApp number\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"whatsapp-button\"\n                >\n                    <FaWhatsapp size={40} color=\"#25D366\" />\n                </a>\n            </div>\n        </main>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}